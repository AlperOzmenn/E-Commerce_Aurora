@model ECommerce.Application.DTOs.ProductDTOs.ProductDTO

<div class="col-12 col-sm-6 col-md-4 col-lg-3 mb-4">
    <div class="card h-100 shadow-sm border-0">
        <img src="@Model.ImageUrl"
             loading="lazy"
             class="card-img-top"
             alt="@Model.Name"
             style="height: 220px; object-fit: cover;"
             onerror="this.onerror=null;this.src='/images/default-product.png';" />

        <div class="card-body d-flex flex-column justify-content-between">
            <!-- Kategori ve İndirim -->
            <div class="d-flex justify-content-between align-items-center mb-2">
                <span class="badge bg-secondary">@Model.CategoryName</span>

                @if (Model.Discount.HasValue && Model.Discount.Value > 0)
                {
                    <span class="badge bg-danger">-%@(Model.Discount)</span>
                }
            </div>

            <!-- Ürün Başlığı -->
            <h5 class="card-title text-truncate" title="@Model.Name">@Model.Name</h5>

            <!-- Fiyat Bilgisi -->
            <p class="mb-1">
                @if (Model.Discount.HasValue && Model.Discount.Value > 0)
                {
                    <span class="text-muted text-decoration-line-through">₺@Model.UnitPrice.ToString("N2")</span>

                    <br />
                    <span class="fw-bold text-primary fs-5">₺@Model.FinalPrice.ToString("N2")</span>
                }
                else
                {
                    <span class="fw-bold text-primary fs-5">₺@Model.UnitPrice.ToString("N2")</span>
                }
            </p>

            <!-- Renk ve Marka -->
            <p class="text-muted small mb-1">@Model.Brand - @Model.Color</p>

            <!-- Stok Durumu -->
            @if (Model.Stock > 0)
            {
                <span class="badge bg-success mb-2">Stok: @Model.Stock</span>
            }
            else
            {
                <span class="badge bg-danger mb-2">Stokta Yok</span>
            }

            <!-- Butonlar -->
            <div class="d-grid gap-2 mt-2">
                <a asp-controller="Product"
                   asp-action="Detail"
                   asp-route-id="@Model.Id"
                   class="btn btn-outline-primary btn-sm">
                    Detay
                </a>

                @if (Model.Stock > 0)
                {
                    <form asp-controller="Cart" asp-action="AddToCart" method="post">
                        <input type="hidden" name="productId" value="@Model.Id" />
                        <button type="submit" class="btn btn-primary btn-sm">
                            <i class="bi bi-cart-plus"></i> Sepete Ekle
                        </button>
                    </form>
                }
            </div>
        </div>
    </div>
</div>
